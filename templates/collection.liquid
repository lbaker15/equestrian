<!-- /templates/collection.liquid -->
{% comment %}
  The contents of the collection.liquid template can be found in /sections/collection-template.liquid
{% endcomment %}

{% comment %}

This page represents the /collections and /products pages.
It is an optional, but highly recommended, template for your theme.

More info:
- http://docs.shopify.com/manual/configuration/store-customization/taking-control-of-collections-listing

Loop through each collection, except 'frontpage'.
{% endcomment %}

{%- assign collection_count = 0 -%}
{%- assign isEmpty = true -%}

{% comment %}
Count how many collections we have to show
{% endcomment %}
{% if section.settings.display_type == 'all' %}
{% case section.settings.sort %}
{% when 'products_high' or 'products_low' %}
{%- assign list_collections = collections | sort: 'all_products_count' -%}
{% when 'date' or 'date_reversed' %}
{%- assign list_collections = collections | sort: 'published_at' -%}
{% else %}
{%- assign list_collections = collections -%}
{% endcase %}
{% for collection in list_collections %}
{% unless collection.handle == 'frontpage' %}
{%- assign collection_count = collection_count | plus: 1 -%}
{% endunless %}
{% endfor %}
{% else %}
{%- assign collection_count = section.blocks.size -%}
{% endif %}

{% if collection_count > 0 %}
{%- assign isEmpty = false -%}
{% endif %}

{%- assign collection_index = 0 -%}
{%- assign divisible_by_three = collection_count | modulo: 3 -%}
{%- assign divisible_by_two = collection_count | modulo: 2 -%}



{%for tag in collection.tags%}
{%if tag contains ":"%}
{%unless current_tags contains tag%}
{%assign tagGroup = tag | split: ":" | first%}
{%assign tagGroups = tagGroups | append:tagGroup | append: ","%}
{%else%}
{%assign tagGroup = tag | split: ":" | first%}
{%assign activeTags = activeTags | append:tagGroup | append: ","%}
{%endunless%}
{%endif%}
{%endfor%}

{%assign tagGroups = tagGroups | split: "," | uniq%}
{%for group in tagGroups%}
{%if activeTags contains group%}
{%else%}
{%assign newGroup = newGroup | append:group | append: ","%}
{%endif%}
{%endfor%}

{%assign newGroup = newGroup | split: "," | uniq%}
{%for group in newGroup%}
{%for prodloop2 in available_products%}
{%for prodTags in prodloop2.tags%}
{%assign groupName = group | append: ":"%}
{%if prodTags contains groupName%}
{%assign filterOption = prodTags | split: ":" | last%}
{%assign filterOptions = filterOptions | append: filterOption | append: ","%}
{%endif%}
{%endfor%}
{%endfor%}
{%assign groupList = groupList | append: group | append: ":" | append: filterOptions | append: "~"%}
{%assign filterOptions = ""%}
{%endfor%}

{%assign groupList = groupList | split: "~"%}



<div class="product-header-bg"></div>


<div class="collection__grid">
  
<h1>HERE; {{groupList}} </h1> 

  <div class="collection__grid-inner">
    <div class="collection__header">
      <a class="product__grid-link" href="/products">
        <span>
          < </span>back to previous page
      </a>
      <h1>First Edition Collection</h1>
      <h2>{{section.settings.heading-2}}</h2>
    </div>




    <div class="collection__filter">
      <div class="filter-navigation__button mob-heading" onClick="toggleFilterMenu()" style="background-color:#fff">
        Filters <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
          <path
            d="M487.976 0H24.028C2.71 0-8.047 25.866 7.058 40.971L192 225.941V432c0 7.831 3.821 15.17 10.237 19.662l80 55.98C298.02 518.69 320 507.493 320 487.98V225.941l184.947-184.97C520.021 25.896 509.338 0 487.976 0z" />
        </svg></div>
      <div class="filters-with-grid">
        <div class="filter-navigation__wrapper">
          <div class="filter-navigation__groups" id="filter-navigation__groups">
            {%-for groupItem in groupList-%}
            {%assign groupHeading = groupItem | split: ":" | first%}
            {%assign groupOptionsString = groupItem | split: ":" | last %}
            {%assign groupOptions = groupItem | split: ":" | last | split: "," | uniq | sort%}

            {%for filter in activeFilters%}
            {%assign lstrip = filter | lstrip%}
            {%if lstrip == groupHeading%}
            {%case lstrip%}
            {%when 'Category'%}
            {%unless collection.title == "Mens" or collection.title == "Ladies" or collection.title == "Kids" or
            collection.title == "Children"%}
            <div class="filter-navigation__group">
              <div class="filter-navigation__heading" onClick="toggleFilter(this)">
                {{groupHeading}}{%if groupHeading =='Thickness'%}
                <span class="group-modal" tabindex="0">?</span>{%endif%}<span class="group-expand"></span>
              </div>
              <ul class="filter-navigation__options" style="display:none">
                <div class="filter-navigation__optionswrap">
                  {%for option in groupOptions%}
                  {%assign groupOptionsCount = groupOptionsString | split: option%}
                  {%assign groupOptionsCount = groupOptionsCount.size | minus: 1%}
                  <li class="filter-navigation__option">
                    {% assign group_option = groupHeading | append: ':' | append: option | handleize%}
                    <input type="checkbox" id="{{group_option}}" name="{{option}}" value="{{group_option}}" {%if
                      request.path contains group_option %} checked{%endif%} onClick="changeFilter(this.id)">
                    <label for="{{group_option}}">{{option | capitalize}} ({{groupOptionsCount}})</label>
                  </li>
                  {%endfor%}
                </div>
              </ul>
            </div>
            {%endunless%}
            {%else%}
            <div class="filter-navigation__group">
              <div class="filter-navigation__heading" onClick="toggleFilter(this)">{{groupHeading}}{%if groupHeading ==
                'Thickness'%}<span class="group-modal" tabindex="0">?</span>{%endif%}<span class="group-expand"></span>
              </div>
              <ul class="filter-navigation__options" style="display:none">
                <div class="filter-navigation__optionswrap">
                  {%for option in groupOptions%}
                  {%assign groupOptionsCount = groupOptionsString | split: option%}
                  {%assign groupOptionsCount = groupOptionsCount.size | minus: 1%}
                  <li class="filter-navigation__option">
                    {% assign group_option = groupHeading | append: ':' | append: option | handleize%}
                    <input type="checkbox" id="{{group_option}}" name="{{option}}" value="{{group_option}}" {%if
                      request.path contains group_option %} checked{%endif%} onClick="changeFilter(this.id)">
                    <label for="{{group_option}}">{{option | capitalize}} ({{groupOptionsCount}})</label>
                  </li>
                  {%endfor%}
                </div>
              </ul>
            </div>
            {%endcase%}
            {%endif%}
            {%endfor%}
            {%-endfor-%}
          </div>

          {%-if activeTags-%}
          <div class="filter-navigation__group"
            style="max-width:100%;padding:10px 20px 0;background-color:transparent;flex-flow:row wrap">
            <div class="filter-navigation__active" style="font-weight:700;margin-right:15px"><span class="group-close"
                onClick="clearAllFilters()">Clear all</span></div>
            {%assign activeTags = activeTags | split: ","%}
            {%for active in current_tags%}
            {%assign activeCat = active | split: ":" | first%}
            {%assign activeOption = active | split: ":" | last%}
            {%assign activeId = active | handleize%}
            <div class="filter-navigation__active">{{activeCat}}: {{activeOption}}<span class="group-close"
                style="margin-left:5px" id="{{activeId}}" onClick="changeFilter(this.id)">&#10005;</span></div>
            {%endfor%}

          </div>
          {%-endif-%}
        </div>
      </div>
    </div>





    <div class="collection__col-section">
      {% for product in collections.first-edition.products %}
      <div class="collection__col col-{{forloop.index}}">
        <div class="first-inner inner">
          <div {% assign img=product.featured_image %} {% assign img2=product.images[1] %} {% if img %}
            style="background-image: url('{{img | image_url}}')" {% endif %} class="collection__img"></div>
          <div class="images">
            {% for image in product.images %}
            {% if forloop.index < 5 %} <div style="background-image: url('{{image | image_url}}')"
              class="collection__img-s">
          </div>
          {% endif %}
          {% endfor %}
        </div>
      </div>
      <div class="inner">
        <div class="collection__text">
          <h3><span>First edition</span></h3>
          <h4>{{product.title}} <em>|</em> <span>{{product.price | money}}</span></h4>
          <img src="{{ img2 | img_url }}" />
        </div>
      </div>
      <div class="line">
        <hr />
      </div>
    </div>
    {% endfor %}
  </div>

</div>
{% for collection in collections %}

{% endfor %}
{% if paginate.pages > 1 %}{{ paginate | default_pagination }}{% endif %}
</div>
</div>

